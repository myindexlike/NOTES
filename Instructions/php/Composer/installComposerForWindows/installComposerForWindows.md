# Устанока Composer'a на Windows и использование его в PhpStorm

## Что такое Composer и зачем он нужен

![Логотип Composer](composer-logo.png) 

Composer ([getcomposer.org](https://getcomposer.org/)) — это менеджер зависимостей для PHP. Вы можете описать от каких библиотек зависит ваш проект и Composer установит нужные библиотеки за вас!  

**Кратко, как это работает:**  
1. У вас есть проект, который зависит от нескольких библиотек.
2. Некоторые из этих библиотек зависят от других библиотек.
3. Вы описываете в своём проекте те библиотеки, от которых непосредственно зависит ваш код.
4. Composer находит нужные версии требуемых библиотек для всего проекта, скачивает их и устанавливает в папку вашего проекта. 

**Как мы это делали раньше:** скачивали нужные нам фреймворки и библиотеки, думали куда их распаковать, писали в проекте кучу require (или require_once для надёжности).  

**Как мы это сделаем теперь:** используем Composer — он сам скачает все библиотеки и сгенерирует для нас autoload.php. Кроме того, если мы захотим показать «Super Hello World» коллегам, достаточно будет опубликовать код нашего проекта на github (или ещё где-нибудь), не включая всех требуемых библиотек в репозиторий и не готовя длинной инструкции по их установке. Нашим коллегам достаточно будет скачать (склонировать) «Super Hello World» и выполнить команду  

`php composer.phar install`  

## Установка Composer  

1. Качаем установочный файл для Windows перейдя по ссылке [https://getcomposer.org/download/](https://getcomposer.org/download/) и скачиваем файл `Composer-Setup.exe`.
2. Запускаем установку.  
    При установке нужно будет указать путь к файлу `php.exe`.  
    Если у вас стоит xampp то этот файл находится по пути `php/php.exe` относительно папки `xampp`. Дальше просто жмем далее.  

**Готово! Composer установлен**.  
Для проверки нужно открыть консоль Windows (`Windows+R` > `cmd` > `OK`) и написать команду `composer`. После чего нам покажет информацию о версии и доступных командах.  
![Информация о composer](composer-info.png)  

## Использование Composer в проектах PhpStorm  

Если у нас в проекте находится целая админка а нам нужно работать только с программой в определённой папке, то:  

 1. Открываем Терминал PhpStorm (`Alt+F12`) и переходим в нужную нам папку.  
    Для перехода между папками используется команда `cd <путь>` `enter`.
 2. Выполняем команду `composer init`.  
    Нас попросит ввести данные проекта, их можно не вводить и все пропускать. В конце в папке в которой мы инициализируем composer создастся файл `composer.json` в котором будут поля с данными которые мы ввсели при инициализации. Их можно будет редактировать.
3. После того как файл `composer.json` сгенерировался открываем его.  
    Но примерно будет следующего вида:  
![Файл composer.json по умолчанию](composerjson-default.png)  
Нам нужно добавить настройки авторазгрузчика. Для етого в самом конце файла (перед последней закрывающей скобкой) дописываем правила `autoload` как на картинке:  
![Файл composer.json с минимальными настройками автозагрузчика](composerjson-autoload.png)  
Тут мы задали правила поиска файлов `psr-4`, тоесть на основе пространства имен ([Советую прочитать](https://github.com/codedokode/pasta/blob/master/php/autoload.md)).  

PhpStorm умеет работать с composer и при редактировании файла composer.json в правом верхнем углу появляются две кнопки: `Install` и `Update`. Нажимаем на `Install`, после чего composer считает то что мы написали в файле и скачает все библиотеки которые подключены в етом файле и загрузит их в папку `vendor` которую он сам создаст.  

Так как мы никаких библиотек не подключали то он загрузит только файлы автозагрузчика.  

Все. Структура проекта готова. Далее следует в индексном файле проекта подключить файл `vendor/autoload.php` и он будет подключать нужные нам файлы по правилам `psr-4`.